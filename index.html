<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Tokenjar : Burp Suite extension. Useful for managing tokens like anti-CSRF, CSurf, Session values. Can be used to set params that require random numbers or params that are computed based on special forumla.">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Tokenjar v2.0</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/DanNegrea/TokenJar">View on GitHub</a>

          <h1 id="project_title">Tokenjar v2.0</h1>
          <h2 id="project_tagline">Burp Suite extension. Useful for managing tokens like anti-CSRF, CSurf, Session values. Can be used to set params that require random numbers or params that are computed based on special forumla.</h2>            
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h2>
<a id="welcome-to-tokenjar-page" class="anchor" href="#welcome-to-tokenjar-page" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Welcome to TokenJar Page.</h2>

<p>If you’re using Burp Suite Free or Pro you have already noticed that sometimes maintaining a session can be a difficult task.
This extension is the easiest way to manage tokens used for different purposes. Examples include: anti-CSRF, CSurf value, parameters that require a unique/random value and even Session values that are computed based on a formula.</p>

<p>TokenJar was designed to overcome the limitations of build-in Cookie Jar. It proves very useful when working together with Session Handling Rules.</p>

<h2>
<a id="download-the-plugin" class="anchor" href="#download-the-plugin" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Download the plugin</h2>

<p>The ready to use jar can be downloaded from <a href="https://github.com/DanNegrea/TokenJar/releases/download/2.0/TokenJar.jar">here</a></p>

<p>Go ahead and improve this extension. You can browse through the code <a href="https://github.com/DanNegrea/TokenJar">here</a>.</p>

<h2>
<a id="install-instructions" class="anchor" href="#install-instructions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Install instructions</h2>

<ol>
<li>Download the jar.</li>
<li>In Burp navigate to the Extender tab.</li>
<li>Select "Add" </li>
<li>Extension Type should be set to "Java" and choose "Select file…".</li>
<li>Navigate to the downloaded jar and click "Open" and "Next".</li>
</ol>

<p>If everything is OK, the extension should appear in the list and the "Loaded" checkbox should be checked. </p>

<h2>
<a id="getting-started" class="anchor" href="#getting-started" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Getting Started</h2>

<p>The plugin has it's own Tab called "Token Jar" with a user interface designed around a table that will show you all the information needed.</p>

<ol>
<li>Add a new line</li>

<li>Change extracting settings:<br/>
<b>Path</b>-  a URL that limits the location from where the token is extracted (reponse)<br/>
<b>Regex</b>- expression that identifies the desired value. Must have at least one matching group. Here you can use javascript to concatenate, generate random values, do conversions, etc.<br/>
<b>Eval</b>-  javascript code for transforming the value. grp[1], grp[2], ... return the matched group 1, 2, ...<br/>
</li>

<li>Set an initial value:<br/>
<b>Value</b> - an optional initial value for the first run<br/>
</li>

<li>Set parameter name and location:</b><br/>
<b>Name</b>- token name as it appears in request<br/>
<b>header, url, body, ...</b>- token position in request. Multiple choises are possible.<br/>
<i>header</i> - a custom header contains the token. Token name is without colon ":" <br/>
<i>url</i> - the URL query contains the token as  parameter <br/>
<i>body</i> - the token is an usual POST parameter <br/>
<i>cookie</i> - one of the cookies contains the token <br/>
<i>other</i> - for tokens inside json, xml, xml attribute, multi-part attribute
</li>

<li>Optionally test your regular expression by clicking "Regex".</li>
<li>Enable the line and the master enable checkbox. </li>
<li>All done!</li>
</ol>

<h3>
<a id="example" class="anchor" href="#example" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Example</h3>

<ol>
<li>I added a new line with the scope of extracting the <i>csrf</i> value from a javascript variable. 
<img src="https://raw.githubusercontent.com/DanNegrea/TokenJar/gh-pages/images/example1.png" alt="">
</li>
<li>I tested the Regex and the Eval. To do this I used a response snippet.
<img src="https://raw.githubusercontent.com/DanNegrea/TokenJar/gh-pages/images/example2.png" alt="">
</li>
<li>Enable the line and the master switch 
<img src="https://raw.githubusercontent.com/DanNegrea/TokenJar/gh-pages/images/example3.png" alt="">
</li>
</ol>

<h2>
<a id="debug" class="anchor" href="#debug" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Debug</h2>

By enabling debugging real time information can be consulted in the Output window (Extender >Extensions >select TokenJar >Output).

<i><b>Request:</b></i><br/>
<i>parameters</i> - name and type. Case sensitivity matters! <br/>
<i>headers</i> - name and current value <br/>
<i>tokens</i> - that have been processed <br/>
<i>request</i> - full final request (after processing was done) <br/>
<i><b>Request:</b></i><br/>
<i>path</i> - the processed URL<br/>
<i>regex</i> - the expression that matched<br/>
<i>groups</i> - the values captured in each group <br/>


<h2>
<a id="notes" class="anchor" href="#notes" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Notes</h2>

<ul>
<li>Master enable will be unchecked when Burp restarts</li>
<li>State should be preserved after restart, nevertheless, you can save and load the configuration later using the bottom-right bottoms</li>
<li>All token locations (header, url, body, ..) can be enabled if not sure what to use and when this does not matter. <br/>
It matters only when multiple parameters have the same name. By doing so the performance might be impacted.</li>
</ul>

<h2>
<a id="requirements-for-usage" class="anchor" href="#requirements-for-usage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Requirements for usage</h2>

<ul>
<li>Burp Suite Free or Pro</li>
<li>JRE or JDK 1.8</li>
</ul>

<h3>
<a id="requirements-for-building" class="anchor" href="#requirements-for-building" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Requirements for building</h3>

<ul>
<li>Google Guava 25.1</li>
</ul>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Tokenjar maintained by <a href="https://github.com/DanNegrea">DanNegrea</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
